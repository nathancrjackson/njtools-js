let njtdebug=!0;window.njt=new function(t){if(void 0===t)this.debug=!1;else if(t){this.debug=!0,(window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))&&console.log("IE detected! No promises made on NJTools functionality here...")}else this.debug=!1;this.log=function(t){this.debug&&console.log(t)},this.types={UNKNOWN:-3,NAN:-2,UNDEFINED:-1,NULL:0,BOOLEAN:1,NUMBER:2,BIGINT:3,STRING:4,SYMBOL:5,FUNCTION:6,ARRAY:7,OBJECT:8,INFINITY:9},this.js=new function(){this.typeOf=function(t){let e=typeof t;return"undefined"===e?njt.types.UNDEFINED:"boolean"===e?njt.types.BOOLEAN:"number"===e?NaN===t?njt.types.NAN:t===1/0?njt.types.INFINITY:njt.types.NUMBER:"bigint"===e?njt.types.BIGINT:"string"===e?njt.types.STRING:"symbol"===e?njt.types.SYMBOL:"function"===e?njt.types.FUNCTION:"object"===e?null===t?njt.types.NULL:Array.isArray(t)?njt.types.ARRAY:njt.types.OBJECT:njt.types.UNKNOWN},this.validate=function(t,e){for(let n in e)if(njt.js.typeOf(t[n])!=e[n])return!1;return!0},this.getRandomInt=function(t,e){return e+=1,t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t)+t)}},this.dom=new function(){this.getElementById=function(t){return document.getElementById(t)},this.getElementsByAttribute=function(t){return document.querySelectorAll("["+t+"]")},this.getElementsByAttributeWithValue=function(t,e){return document.querySelectorAll("["+t+'="'+e+'"]')},this.getElementsByClass=function(t){return document.getElementsByClassName(t)},this.getElementsWhereClassContains=function(t){return document.querySelectorAll('[class*="'+t+'"]')},this.getElementsWhereClassBegins=function(t){return document.querySelectorAll('[class^="'+t+'"]')},this.getElementsWhereClassEnds=function(t){return document.querySelectorAll('[class$="'+t+'"]')}},this.req=new function(){this.get=function(t,e){let n=new XMLHttpRequest;n.open("GET",t,!0),n.onload=e,n.send()},this.post=function(t,e,n){let i=new XMLHttpRequest;i.open("POST",t,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded");let s="";for(let t in e)s.length>0&&(s+="&"),s=s+Structure.encodePOST(t)+"="+Structure.encodePOST(e[t]);i.onload=n,i.send(s)}},this.event=new function(){this.funct=new Object,this.queue=new Object,this.eventHandler=function(t){let e=t.target.attributes["njtevent"+t.type];if(void 0!==e){let n=njt.event.funct[e.value];"function"==typeof n&&n(t)}},this.addFunction=function(t,e){njt.event.funct[t]=e},this.createQueue=function(t,e,n){this.queue[t]=new this.queueWrapper(e,n)},this.queueWrapper=function(t,e){this.eventOccured=!1,this.functionArray=[],this.push=function(t){this.eventOccured?(njt.log("Event "+e+" has passed executing immediately"),t()):(njt.log("Added function to "+e+" queue"),this.functionArray.push(t))},t.addEventListener(e,function(t){this.eventOccured=!0;for(var e=this.functionArray.length,n=0;n<e;)this.functionArray[n](t),n+=1}.bind(this))},this.triggerSyntheticEvent=function(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:n}))},this.createQueue("htmlloaded",document,"DOMContentLoaded"),this.createQueue("pageloaded",window,"load")},this.id=null,this.element=null,this.snip=null,this.modal=null,this.formbuilder=null}(njtdebug);njt.id=new function(){this.lazyUniqueId=Date.now(),this.getLazyUniqueId=function(){return result=this.lazyUniqueId,this.lazyUniqueId++,result}},njt.element=new function(){this.createElement=function(t,e,n,l,i){let s=null;if(njt.js.typeOf(t)===njt.types.STRING){if(""===t)return document.createTextNode(i);if(s=document.createElement(t),njt.js.typeOf(l)===njt.types.OBJECT){let t=Object.keys(l);for(let e=0,n=t.length;e<n;++e){var o=t[e];s.setAttribute(o,l[o])}}njt.js.typeOf(e)===njt.types.STRING&&s.setAttribute("id",e),njt.js.typeOf(n)===njt.types.STRING&&(s.className=n),njt.js.typeOf(i)!==njt.types.STRING&&njt.js.typeOf(i)!==njt.types.NUMBER&&njt.js.typeOf(i)!==njt.types.BIGINT||(s.innerHTML=i)}return s},this.wrapElement=function(t,e){let n=njt.element.buildElementTree(t);return n.appendChild(e),n},this.buildElementTree=function(t){let e=null;if(njt.js.typeOf(t)===njt.types.OBJECT&&(e=this.createElement(t.t,t.i,t.c,t.a,t.h),null!==e)){if(njt.js.typeOf(t.e)===njt.types.ARRAY)for(let n=0;n<t.e.length;n++){let l=this.buildElementTree(t.e[n]);null!==l&&e.appendChild(l)}njt.js.typeOf(t.w)===njt.types.OBJECT&&(e=this.wrapElement(t.w,e))}return e}},njt.snip=new function(){this.caseSensitive=!1,this.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","gi"),this.valueMap=new Object,this.snipMap=new Object,this.vars=new Array,this.setCaseSensitive=function(t){1==t?(njt.snip.caseSensitive=!0,njt.snip.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","g")):(njt.snip.caseSensitive=!1,njt.snip.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","gi"))},this.valueMapPush=function(t,e){this.caseSensitive||(t=t.toLowerCase()),this.valueMap[t]=e},this.valueMapDelete=function(t){this.caseSensitive||(t=t.toLowerCase()),void 0!==this.valueMap[t]&&delete this.valueMap[t]},this.valueMapClear=function(){this.valueMap=new Object},this.examineString=function(t){let e=new Array,n=null,l=null;for(;null!==(n=this.regex.exec(t));)l=this.caseSensitive?n[1]:n[1].toLowerCase(),-1===e.indexOf(l)&&e.push(l),-1===this.vars.indexOf(l)&&this.vars.push(l);return e},this.examineById=function(t){let e=new Array,n=njt.dom.getElementsByAttributeWithValue("snip-id",t);return 1===n.length&&(e=this.examineString(n[0].innerHTML)),e},this.examineByGroup=function(t){let e=new Array,n=njt.dom.getElementsByAttributeWithValue("snip-group",t);if(n.length>0)for(let t=0;t<n.length;t++){let l=this.examineString(n[t].innerHTML);for(let t=0;t<l.length;t++)-1==e.indexOf(l[t])&&e.push(l[t])}return e},this.processString=function(t){let e="",n=new Array,l=null;for(;null!==(l=this.regex.exec(t));){let t={};t.i=l.index,t.l=l[0].length,n.push(t)}index=0;for(let l=0;l<n.length;l++){let i=n[l];i.i!==index&&(e+=t.substring(index,i.i)),index=i.i+i.l;let s=t.substring(i.i+2,index-2);this.caseSensitive||(s=s.toLowerCase()),void 0===this.valueMap[s]?e+="{:"+s+":}":e+=this.valueMap[s]}return index<t.length&&(e+=t.substring(index,t.length)),e},this.processById=function(t){let e=njt.dom.getElementsByAttributeWithValue("snip-id",t);1===e.length&&(void 0===this.snipMap[t]&&(this.snipMap[t]=e[0].innerHTML),e[0].innerHTML=this.processString(this.snipMap[t]))},this.processByGroup=function(t){let e=njt.dom.getElementsByAttributeWithValue("snip-group",t);if(e.length>0)for(let n=0;n<e.length;n++){let l=e[n].getAttribute("snip-id");null===l&&(l=t+njt.id.getLazyUniqueId(),e[n].setAttribute("snip-id",l)),void 0===this.snipMap[l]&&(this.snipMap[l]=e[n].innerHTML),e[n].innerHTML=this.processString(this.snipMap[l])}},this.resetById=function(t){let e=njt.dom.getElementsByAttributeWithValue("snip-id",t);1===e.length&&void 0!==this.snipMap[t]&&(e[0].innerHTML=this.snipMap[t])},this.resetByGroup=function(t){let e=njt.dom.getElementsByAttributeWithValue("snip-group",t);if(e.length>0)for(let t=0;t<e.length;t++){let n=e[t].getAttribute("snip-id");null!==n&&void 0!==this.snipMap[n]&&(e[t].innerHTML=this.snipMap[n])}},this.initByClass=function(t){let e=0,n=njt.dom.getElementsByClass(t);for(let l=0;l<n.length;l++)null===n[l].getAttribute("snip-group")&&null===n[l].getAttribute("snip-id")&&(n[l].setAttribute("snip-group",t),snipId=t+njt.id.getLazyUniqueId(),n[l].setAttribute("snip-id",snipId),e++);return e},this.initByClassIdPair=function(t){let e=0,n=njt.dom.getElementsWhereClassBegins(t+"-"),l=t.length+2;for(let i=0;i<n.length;i++)for(let s=0;s<n[i].classList.length;s++){let o=n[i].classList[s];o.length>l&&o.substring(0,t.length)===t&&null===n[i].getAttribute("snip-group")&&null===n[i].getAttribute("snip-id")&&(n[i].setAttribute("snip-group",t),n[i].setAttribute("snip-id",o.substring(t.length+1)),e++)}return e}},njt.modal=new function(){this.initModal=function(){this.modalShell=document.createDocumentFragment();let t=document.createElement("div");t.setAttribute("id",this.modalBackgroundId),t.setAttribute("modal-element","background"),t.className=this.modalBackgroundClass;let e=document.createElement("div");e.setAttribute("id",this.modalFrameId),e.className=this.modalFrameClass;let n=document.createElement("div");n.setAttribute("id",this.modalCloseWrapperId);let l=document.createElement("span");l.innerHTML="&times;",l.className=this.modalCloseClass,l.setAttribute("id",this.modalCloseId),l.setAttribute("modal-element","close-button");let i=document.createElement("div");i.setAttribute("id",this.modalContentId),i.className=this.modalContentClass,n.appendChild(l),e.appendChild(n),e.appendChild(i),t.appendChild(e),this.modalShell.appendChild(t),document.addEventListener("mousedown",(function(t){let e=t.target.getAttribute("modal-element");null!==e?t.offsetX<t.target.clientWidth&&(njt.modal.lastClick=e):njt.modal.lastClick=null})),document.addEventListener("mouseup",(function(t){if(null!==njt.modal.lastClick){let e=t.target.getAttribute("modal-element");e===njt.modal.lastClick&&("background"!==e&&"close-button"!==e||t.offsetX<t.target.clientWidth&&njt.modal.close(t)),njt.modal.lastClick=null}}))},this.loadModals=function(){let t=document.querySelectorAll("[modal-wrapper]"),e=null,n=null,l=null;t.length;for(let i=0;i<t.length;i++){for(e=t[i].getAttribute("modal-wrapper"),n=t[i].getAttribute("modal-open"),l=t[i].getAttribute("modal-close"),currentChildren=t[i].children,this.contentArray[e]={},this.contentArray[e].modal=document.createDocumentFragment();currentChildren.length>0;)this.contentArray[e].modal.appendChild(currentChildren[0]);this.contentArray[e].open="string"==typeof n?n:null,this.contentArray[e].close="string"==typeof l?l:null,t[i].parentNode.removeChild(t[i])}},this.open=function(t,e){njt.log("Trying To Open Modal"),null!=this.contentArray[t].open?(njt.log("Running Custom Open Modal Function"),njt.modal.openFunctions[this.contentArray[t].open](t,e)):this.openNow(t)},this.openNow=function(t){njt.log("Modal Open Started"),null===this.currentContentId&&"string"==typeof t&&void 0!==this.contentArray[t]&&(njt.modal.modalShell.querySelector("#"+this.modalContentId).appendChild(this.contentArray[t].modal),document.body.appendChild(this.modalShell),this.currentContentId=t),njt.log("Modal Open Ended")},this.close=function(t){njt.log("Trying To Close Modal"),null!=this.contentArray[this.currentContentId].close?(njt.log("Running Custom Close Modal Function"),njt.modal.closeFunctions[this.contentArray[this.currentContentId].close](t)):this.closeNow()},this.closeNow=function(){if(njt.log("Modal Close Started"),null!==this.currentContentId){let t=document.getElementById(this.modalContentId);for(;t.childNodes.length>0;)this.contentArray[this.currentContentId].modal.appendChild(t.childNodes[0]);this.modalShell.appendChild(document.getElementById(this.modalBackgroundId)),this.currentContentId=null}njt.log("Modal Close Ended")},this.modalShell=null,this.currentContentId=null,this.contentArray=[],this.modalBackgroundId="modal-background",this.modalBackgroundClass="modal-background",this.modalFrameId="modal-frame",this.modalFrameClass="modal-frame",this.modalCloseWrapperId="modal-close-wrapper",this.modalCloseId="modal-close-button",this.modalCloseClass="modal-close",this.modalContentId="modal-content",this.modalContentClass="modal-content",this.lastClick=null,this.contentArray=[],this.openFunctions={},this.closeFunctions={},njt.event.queue.htmlloaded.push((function(){njt.log("Starting to initialise Modals"),njt.modal.initModal(),njt.modal.loadModals(),njt.log("Finished initialising Modals")}))},njt.formbuilder=new function(){this.generate=function(t){let e=null;if(njt.js.typeOf(t)===njt.types.STRING&&(t=JSON.parse(t)),"njt/form"===t.t){if(e=njt.element.createElement("form",t.i,t.c,t.a),njt.js.typeOf(t.e)===njt.types.ARRAY)for(let n=0;n<t.e.length;n++){let l=null,i=(t.e[n],t.e[n].t.split("/"));3===i.length?"njt"===i[0]&&"form"===i[1]&&njt.js.typeOf(this.typeBuilders[i[2]])===njt.types.FUNCTION&&(l=this.typeBuilders[i[2]](t.e[n])):1===i.length&&(l=njt.element.buildElementTree(t.e[n])),null!==l&&e.appendChild(l)}if(njt.js.typeOf(t.w)===njt.types.OBJECT){let n=njt.element.createElement(t.w.t,t.w.i,t.w.c,t.w.a);n.appendChild(e),e=n}}return e},this.typeBuilders={},this.typeBuilders.lineinput=function(t){let e=null;if(njt.js.typeOf(t.i)===njt.types.STRING){t.l;let n=t.i,l={type:"text",class:"njt-form-lineinput",name:n};njt.js.typeOf(t.p)===njt.types.STRING&&(l.placeholder=t.p),e=njt.element.createElement("div",n+"-wrapper",t.c);let i=njt.element.createElement("input",n+"-input",null,l);if(njt.js.typeOf(t.l)===njt.types.STRING){let l=njt.element.createElement("label",n+"-label",null,{for:n+"-input"},t.l+i.outerHTML);e.appendChild(l)}else e.appendChild(i)}return e},this.typeBuilders.multilineinput=function(t){let e=null;if(njt.js.typeOf(t.i)===njt.types.STRING){t.l;let n=t.i,l={class:"njt-form-multilineinput",name:n};njt.js.typeOf(t.p)===njt.types.STRING&&(l.placeholder=t.p),e=njt.element.createElement("div",n+"-wrapper",t.c);let i=njt.element.createElement("textarea",n+"-input",null,l);if(njt.js.typeOf(t.l)===njt.types.STRING){let l=njt.element.createElement("label",n+"-label",null,{for:n+"-input"},t.l+i.outerHTML);e.appendChild(l)}else e.appendChild(i)}return e},this.typeBuilders.dropdown=function(t){let e=null;if(njt.js.typeOf(t.i)===njt.types.STRING){t.l;let n=t.i,l={class:"njt-form-dropdown",name:n},i=null;njt.js.typeOf(t.s)===njt.types.STRING&&(i=t.s),e=njt.element.createElement("div",n+"-wrapper",t.c);let s=njt.element.createElement("select",n+"-input",null,l);if(njt.js.typeOf(t.v)===njt.types.ARRAY)for(let e=0;e<t.v.length;e++)t.v[e].v===i?s.appendChild(njt.element.createElement("option",null,null,{value:t.v[e].v,selected:1},t.v[e].h)):s.appendChild(njt.element.createElement("option",null,null,{value:t.v[e].v},t.v[e].h));if(njt.js.typeOf(t.l)===njt.types.STRING){let l=njt.element.createElement("label",n+"-label",null,{for:n+"-input"},t.l+s.outerHTML);e.appendChild(l)}else e.appendChild(s)}return e}};